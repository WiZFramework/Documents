<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<link href="css/main.css" rel="stylesheet" type="text/css">
<title>言語を作ろうプロジェクト（2019年）</title>
</head>
<body>
<!-- 全体コンテナ　-->
<div id="container">
<div id="header">
<h3>０４．インタプリタの作成</h3>
</div>
<!-- コンテンツ　-->
<div id="contents">
<h3>０４－０２．statement.h</h3>
<div class="box1">
<pre>
#pragma once

namespace ore {

    //--------------------------------------------------------------------------------------
    ///  文タイプ
    //--------------------------------------------------------------------------------------
    enum class StatementType {
        nullStm,
        expressionStm,
        blockStm,
        ifStm,
        whileStm,
        forStm,
        returnStm,
        breakStm,
        continueStm,
        printStm,
        setConfigStm,
        stmTypeCount
    };

    enum class SmtResType {
        voidType,
        continueType,
        breakType,
        returnTpe,
    };

    struct SmtRes {
        SmtResType m_Type;
        Value m_RetValue;
        bool m_CaseExec;
        SmtRes() :
            m_Type(SmtResType::voidType),
            m_RetValue(), m_CaseExec(false){}
    };

    //--------------------------------------------------------------------------------------
    ///  文などの親
    //--------------------------------------------------------------------------------------
    class StmExBase : public ObjBase {
    protected:
        StmExBase(ObjType type) :
            ObjBase(type) {}
    public:
        virtual ~StmExBase() {}
        //voidの実行関数
        virtual SmtRes Excute() const {
            return SmtRes();
        }
    };

    //--------------------------------------------------------------------------------------
    ///  文
    //--------------------------------------------------------------------------------------
    class Statement : public StmExBase {
    protected:
        Statement(StatementType type);
    public:
        virtual ~Statement();
        StatementType getType()const;
    private:
        // pImplイディオム
        struct Impl;
        Impl* pImpl;
    };

    //--------------------------------------------------------------------------------------
    ///  式文クラス
    //--------------------------------------------------------------------------------------
    class ExpressionStm : public Statement {
    public:
        ExpressionStm(const Expression* exp);
        ExpressionStm();
        virtual ~ExpressionStm();
        const Expression* getExp()const;
        virtual SmtRes Excute() const  override;
    private:
        // pImplイディオム
        struct Impl;
        Impl* pImpl;
    };

    //--------------------------------------------------------------------------------------
    ///  if文クラス
    //--------------------------------------------------------------------------------------
    class IfStm : public Statement {
    public:
        IfStm(const Expression* condition, const Statement* stm);
        virtual ~IfStm();
        const Expression* getCondition()const;
        const Statement* getStatement()const;
        virtual SmtRes Excute() const  override;
    private:
        // pImplイディオム
        struct Impl;
        Impl* pImpl;
    };

    //--------------------------------------------------------------------------------------
    ///  ifelse文クラス
    //--------------------------------------------------------------------------------------
    class IfElsStm : public Statement {
    public:
        IfElsStm(const Expression* condition, const Statement* stm, const Statement* elsstm);
        virtual ~IfElsStm();
        const Expression* getCondition()const;
        const Statement* getStatement()const;
        const Statement* getElsStatement()const;
        virtual SmtRes Excute() const  override;
    private:
        // pImplイディオム
        struct Impl;
        Impl* pImpl;
    };


    //--------------------------------------------------------------------------------------
    ///  case文クラス
    //--------------------------------------------------------------------------------------
    class CaseStm : public Statement {
    public:
        CaseStm(const Expression* exp, const Statement* stm);
        virtual ~CaseStm();
        const Expression* getExp()const;
        Value getExpExcute()const ;
        const Statement* getStatement()const;
        virtual SmtRes Excute() const  override;
    private:
        // pImplイディオム
        struct Impl;
        Impl* pImpl;
    };

    //--------------------------------------------------------------------------------------
    ///  default文クラス
    //--------------------------------------------------------------------------------------
    class DefaultStm : public Statement {
    public:
        DefaultStm(const Statement* stm);
        virtual ~DefaultStm();
        const Statement* getStatement()const;
        virtual SmtRes Excute() const  override;
    private:
        // pImplイディオム
        struct Impl;
        Impl* pImpl;
    };


    //--------------------------------------------------------------------------------------
    ///  switch文クラス
    //--------------------------------------------------------------------------------------
    class SwitchStm : public Statement {
    public:
        SwitchStm(const Expression* exp, const Statement* stm);
        virtual ~SwitchStm();
        const Expression* getExp()const;
        const Statement* getStatement()const;
        virtual SmtRes Excute() const  override;
    private:
        // pImplイディオム
        struct Impl;
        Impl* pImpl;
    };



    //--------------------------------------------------------------------------------------
    ///  while文クラス
    //--------------------------------------------------------------------------------------
    class WhileStm : public Statement {
    public:
        WhileStm(const Expression* condition, const Statement* stm);
        virtual ~WhileStm();
        const Expression* getCondition()const;
        const Statement* getStatement()const;
        virtual SmtRes Excute() const  override;
    private:
        // pImplイディオム
        struct Impl;
        Impl* pImpl;
    };

    //--------------------------------------------------------------------------------------
    ///  for文クラス
    //--------------------------------------------------------------------------------------
    class ForStm : public Statement {
    public:
        ForStm(const Statement* initstm, const Expression* condition, const Expression* post, const Statement* stm);
        virtual ~ForStm();
        const Statement* getInitStatement()const;
        const Expression* getCondition()const;
        const Expression* getPost()const;
        const Statement* getStatement()const;
        virtual SmtRes Excute() const  override;
    private:
        // pImplイディオム
        struct Impl;
        Impl* pImpl;
    };

    //--------------------------------------------------------------------------------------
    ///  foreach文クラス
    //--------------------------------------------------------------------------------------
    class ForeachStm : public Statement {
    public:
        ForeachStm(const Expression* arr, const char* key, const char* val, const Statement* stm);
        virtual ~ForeachStm();
        const Expression* getArray()const;
        const char* getKey()const;
        const char* getVal()const;
        const Statement* getStatement()const;
        virtual SmtRes Excute() const  override;
    private:
        // pImplイディオム
        struct Impl;
        Impl* pImpl;
    };



    //--------------------------------------------------------------------------------------
    ///  continue文クラス
    //--------------------------------------------------------------------------------------
    class ContinueStm : public Statement {
    public:
        ContinueStm();
        virtual ~ContinueStm();
        virtual SmtRes Excute() const  override;
    };


    //--------------------------------------------------------------------------------------
    ///  break文クラス
    //--------------------------------------------------------------------------------------
    class BreakStm : public Statement {
    public:
        BreakStm();
        virtual ~BreakStm();
        virtual SmtRes Excute() const  override;
    };


    //--------------------------------------------------------------------------------------
    ///  return文クラス
    //--------------------------------------------------------------------------------------
    class ReturnStm : public Statement {
    public:
        ReturnStm();
        ReturnStm(const Expression* retexp);
        virtual ~ReturnStm();
        const Expression* getRetExp()const;
        virtual SmtRes Excute() const  override;
    private:
        // pImplイディオム
        struct Impl;
        Impl* pImpl;
    };

    //--------------------------------------------------------------------------------------
    ///  文リストクラス
    //--------------------------------------------------------------------------------------
    class StatementList : public StmExBase {
    public:
        StatementList(const Statement* stm);
        virtual ~StatementList();
        const Statement* getStm() const;
        StatementList* getNext()const;
        void setNext(StatementList* next);
        virtual SmtRes Excute() const  override;
        SmtRes ExcuteFromCase(Value val)const;
        SmtRes ExcuteFromDefault()const;
    private:
        // pImplイディオム
        struct Impl;
        Impl* pImpl;
    };

    //--------------------------------------------------------------------------------------
    ///  ブロック文クラス
    //--------------------------------------------------------------------------------------
    class BlockStm : public Statement {
    public:
        BlockStm(StatementList* stml);
        BlockStm();
        virtual ~BlockStm();
        const StatementList* getStatementList()const;
        virtual SmtRes Excute() const  override;
        SmtRes ExcuteFromCase(Value val)const;
        SmtRes ExcuteFromDefault()const;
    private:
        // pImplイディオム
        struct Impl;
        Impl* pImpl;
    };

    //--------------------------------------------------------------------------------------
    ///  パラメータリストクラス
    //--------------------------------------------------------------------------------------
    class ParameterList : public ObjBase {
    public:
        ParameterList();
        ParameterList(const char* ident);
        virtual ~ParameterList();
        const char* getIdent() const;
        ParameterList* getNext()const;
        void setNext(ParameterList* next);
    private:
        // pImplイディオム
        struct Impl;
        Impl* pImpl;
    };

    //--------------------------------------------------------------------------------------
    ///  function定義クラス
    //--------------------------------------------------------------------------------------
    class FunctionDefineStm : public Statement {
    public:
        FunctionDefineStm(const char* ident, const ParameterList* pml, const Statement* stm);
        virtual ~FunctionDefineStm();
        const ParameterList* getParamList() const;
        virtual SmtRes Excute() const  override;
    private:
        // pImplイディオム
        struct Impl;
        Impl* pImpl;
    };

    //--------------------------------------------------------------------------------------
    ///  print文
    //--------------------------------------------------------------------------------------
    class PrintStm : public Statement {
    public:
        PrintStm(const Expression* target, bool nflg);
        virtual ~PrintStm();
        const Expression* getExpression()const;
        bool getNflg() const;
        virtual SmtRes Excute() const  override;
    private:
        // pImplイディオム
        struct Impl;
        Impl* pImpl;
    };

    //--------------------------------------------------------------------------------------
    ///  setConfig文
    //--------------------------------------------------------------------------------------
    class SetConfigStm : public Statement {
    public:
        SetConfigStm(const char* key, const Expression* val);
        virtual ~SetConfigStm();
        const char* getKey()const;
        const Expression* getVal()const;
        virtual SmtRes Excute() const  override;
    private:
        // pImplイディオム
        struct Impl;
        Impl* pImpl;
    };



}
//end namespace ore
</pre>
</div>
</div>
<!-- /コンテンツ　-->
<hr>
<!-- フッタ　-->
<ul class="foot_navi">
<li><a href="04_02.html">戻る</a></li>
</ul>
<!-- /フッタ　-->
</div>
<!-- /全体コンテナ　-->
</body>
</html>
