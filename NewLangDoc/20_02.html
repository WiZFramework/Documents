<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<link href="css/main.css" rel="stylesheet" type="text/css">
<title>言語を作ろうプロジェクト（2019年）</title>
</head>
<body>
<!-- 全体コンテナ　-->
<div id="container">
<div id="header">
<h3>ＥＸ．C/C++によるCGIの作成（予備知識）</h3>
</div>
<!-- コンテンツ　-->
<div id="contents">
<h3>ＥＸ－２．CGIで外部ファイルを読み込んで表示する</h3>
　前項では、直接文字列を出力していましたが、<b>言語を作成する</b>といったテーマの場合、<b>なんらかのテキストファイルを読み込む</b>部分と<b>そのテキストファイルに何らかの処理をして出力する</b>という操作が必要です。<br />
　手始めに<b>テキストファイルを読み込んでそのまま出力する</b>プログラムを作成します。<br />
　このプログラムを書く前に、少し<b>ホームディレクトリ</b>を整理してみましょう。<br/>
　現在、ホームディレクトリの前後は下図のようになっていると思います。
<p>&nbsp;</p>
<img src="img/1002a.png" width="80%"/>
<p>図1002a</p>
<p>&nbsp;</p>
　これを以下の様に整理します。
<p>&nbsp;</p>
<img src="img/1002b.png" width="80%"/>
<p>図1002b</p>
<p>&nbsp;</p>
　<b>a.out</b>はコンパイルするとできますので削除してかまいません。<br />
　ここで<b>ore</b>という名前ですが、これは仮の<b>新しい言語名</b>です。<b>俺の言語</b>ということで<b>ore</b>としました。<br />
　もちろん、皆さんは自分たちで考えた名前にしてください。<br />
　このドキュメントでは新しい言語は<b>ore</b>ということで解説したいと思います。<br />
<br/>
　さてこのようなディレクトリ構造にしたところで、新しいテキストファイル<b>index.ore</b>を作成します。以下の内容です。
<div class="box1">
<pre>
&lt;!DOCTYPE html>
&lt;html lang="ja">
&lt;head>
&lt;meta charset="utf-8">
&lt;title>最初の俺&lt;/title>
&lt;/head>
&lt;body>
&lt;h2>俺の世界へようこそ！！&lt;/h2>
&lt;/body>
&lt;/html>
</pre>
</div>
　これを<b>index.ore</b>という名前で<b>UTF-8</b>で保存し、それを<b>ore_src</b>ディレクトリにアップします。<br />
　そのうえで<b>main.cpp</b>を以下のように書き換え、コンパイルし、<b>public_html</b>の中に<b>ore.cgi</b>という名前でコピーします。
<div class="box1">
<pre>
#include &lt;fstream>
#include &lt;iostream>
#include &lt;string>
using namespace std;

int main() {
    ifstream ifs("../ore/ore_src/index.ore");
    if (ifs.fail())
    {
        cout &lt;&lt; "Content-type: text/html\n\n";
        cout &lt;&lt; "ファイル読み込みに失敗しました" &lt;&lt; endl;
        return 0;
    }
    cout &lt;&lt; "Content-type: text/html\n\n";
    string str;
    while (getline(ifs, str))
    {
        cout &lt;&lt; str &lt;&lt; endl;
    }
    return 0;
}
</pre>
</div>
　具体的には<b>cpp_src</b>ディレクトリ内にいるとして
<div class="box1">
<pre>
$ g++ main.cpp  -std=gnu++0x
$ cp a.out ../../public_html/ore.cgi
</pre>
</div>
　そして、ブラウザで
<div class="box1">
<pre>
http://hoge.huga.jp/~[username]/ore.cgi
</pre>
</div>
　とアクセスします。<br />
　太字で
<div class="box1">
<pre>
俺の世界へようこそ！！
</pre>
</div>
　と表示されたら成功です。
<h4>解説</h4>
　今やった一連の処理は、<b>index.ore</b>という名前のテキストファイルを読み込み、それをそのままブラウザに出力する、という処理です。<br />
　今回は<b>そのまま出力</b>していますが
<div class="box1">
<pre>
１．index.oreを読み込む
２、内容を解析する
３、内容を実行し、必要なら出力する
</pre>
</div>
　という仮定を経れば、<b>ore.cgi</b>は、立派な<b>プログラミング言語実行プログラム</b>になります。<br />
　つまり、<b>テキストファイルを何らかの処理をして出力する</b>のが<b>プログラム言語</b>の基本です。<br />
</div>
<!-- /コンテンツ　-->
<hr>
<!-- フッタ　-->
<ul class="foot_navi">
<li><a href="20_01.html">前ページ</a></li>
<li><a href="index.html">目次</a></li>
</ul>
<!-- /フッタ　-->
</div>
<!-- /全体コンテナ　-->
</body>
</html>
